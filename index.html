<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Math X-O</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="matrix-bg"></div>

    <div id="setup-screen" class="screen">
        <div class="glass-card">
            <h1 class="neon-title">إكس أو الحسابية</h1>
            <p class="instr-link" onclick="toggleModal(true)">التعليمات</p>
            
            <div class="setup-form">
                <input type="text" id="teamXName" placeholder="اسم الفريق X" autocomplete="off">
                <input type="text" id="teamOName" placeholder="اسم الفريق O" autocomplete="off">
                
                <div class="settings-grid">
                    <div class="field">
                        <label>نوع العمليات</label>
                        <select id="mathOperation">
                            <option value="random">عشوائي</option>
                            <option value="add">جمع (+)</option>
                            <option value="sub">طرح (-)</option>
                            <option value="mul">ضرب (×)</option>
                            <option value="div">قسمة (÷)</option>
                        </select>
                    </div>
                    <div class="field">
                        <label>المؤقت (ثانية)</label>
                        <select id="timerOption">
                            <option value="0">بدون</option>
                            <option value="5">5</option>
                            <option value="10" selected>10</option>
                            <option value="15">15</option>
                        </select>
                    </div>
                </div>
                <button id="startGameBtn" class="main-cta">ابدأ اللعب</button>
            </div>
        </div>
    </div>

    <div id="game-screen" class="screen hidden">
        <div class="game-wrapper">
            <header class="game-header">
                <div id="cardX" class="team-box x-theme">
                    <span id="labelX">فريق X</span>
                    <div class="score-text">النقاط: <span id="scoreX">0</span></div>
                </div>
                
                <div class="timer-display">
                    <span id="timer-num">--</span>
                </div>

                <div id="cardO" class="team-box o-theme">
                    <span id="labelO">فريق O</span>
                    <div class="score-text">النقاط: <span id="scoreO">0</span></div>
                </div>
            </header>

            <main class="board-container">
                <div id="meta-board"></div>
            </main>

            <footer class="game-footer">
                <button onclick="backToSetup()" class="btn-sub">العودة للإعدادات</button>
                <button onclick="changeBgSpeed()" class="btn-sub">تغيير الخلفية</button>
                <button onclick="toggleTheme()" class="btn-sub">تبديل المظهر</button>
            </footer>
        </div>
    </div>

    <div id="math-popup" class="popup hidden">
        <div class="popup-content">
            <div id="popup-timer-bar"></div>
            <p class="pop-hint">أجب لتنفيذ حركتك:</p>
            <h2 id="question-text">--</h2>
            <div id="answer-input">_</div>
            <div id="success-feedback" class="hidden">✓ إجابة صحيحة!</div>
            
            <div class="numpad">
                <button onclick="keyIn(1)">1</button>
                <button onclick="keyIn(2)">2</button>
                <button onclick="keyIn(3)">3</button>
                <button onclick="keyIn(4)">4</button>
                <button onclick="keyIn(5)">5</button>
                <button onclick="keyIn(6)">6</button>
                <button onclick="keyIn(7)">7</button>
                <button onclick="keyIn(8)">8</button>
                <button onclick="keyIn(9)">9</button>
                <button onclick="clearAll()" class="c-key">C</button>
                <button onclick="keyIn(0)">0</button>
                <button onclick="backspace()" class="b-key">⌫</button>
            </div>
        </div>
    </div>

    <div id="instr-modal" class="modal hidden">
        <div class="modal-box">
            <h2>كيف تلعب؟</h2>
            <ul>
                <li>اختر مربعاً وحل العملية الحسابية لتضع علامتك.</li>
                <li>حركتك في المربع الصغير تحدد لخصمك المربع الكبير القادم.</li>
                <li>إذا أخطأت أو انتهى الوقت، يصبح اللعب حراً للخصم.</li>
            </ul>
            <button onclick="toggleModal(false)" class="close-btn">إغلاق</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
